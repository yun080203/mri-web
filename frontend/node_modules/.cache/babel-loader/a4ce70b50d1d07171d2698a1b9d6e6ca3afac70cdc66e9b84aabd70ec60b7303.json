{"ast":null,"code":"var _jsxFileName = \"D:\\\\GitHub\\\\mri-web-app\\\\frontend\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\n// 导入 React 库中的 useState 和 useReducer 钩子，用于在函数组件中添加状态管理\nimport React, { useState, useReducer, useRef } from 'react';\n// 导入 axios 库，用于发送 HTTP 请求\nimport axios from 'axios';\n// 新增：导入 react-router-dom 中的 BrowserRouter 重命名为 Router，Routes 和 Route 组件\nimport { BrowserRouter as Router, Routes, Route, Link } from 'react-router-dom';\nimport DICOMViewer from './components/Viewer/DICOMViewer';\n// 导入 ImageViewer 和 ComparisonView 组件\nimport ImageViewer from './components/Viewer/ImageViewer';\nimport ComparisonView from './components/Viewer/ComparisonView';\nimport DataManager from './components/DataManagement/DataManager';\nimport './styles/dicom.css';\nimport './styles/App.css';\n// 新增环境变量配置\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_BASE = process.env.REACT_APP_API_BASE || 'http://localhost:5000';\n\n// 使用useReducer整合状态\nconst initialState = {\n  taskId: null,\n  status: 'idle',\n  // 'idle' | 'uploading' | 'processing' | 'completed' | 'failed'\n  progress: 0,\n  result: null,\n  error: null\n};\nfunction uploadReducer(state, action) {\n  switch (action.type) {\n    case 'START_UPLOAD':\n      return {\n        ...state,\n        status: 'uploading',\n        progress: 0\n      };\n    case 'UPDATE_PROGRESS':\n      return {\n        ...state,\n        progress: action.payload\n      };\n    case 'PROCESS_START':\n      return {\n        ...state,\n        status: 'processing',\n        taskId: action.payload\n      };\n    case 'SUCCESS':\n      return {\n        ...state,\n        status: 'completed',\n        result: action.payload\n      };\n    case 'ERROR':\n      return {\n        ...state,\n        status: 'failed',\n        error: action.payload\n      };\n    default:\n      return state;\n  }\n}\n\n// 定义一个名为 App 的函数组件，这是整个应用的根组件\nfunction App() {\n  _s();\n  // 使用 useState 钩子创建状态变量 selectedFile，用于存储用户选择的文件\n  const [selectedFile, setSelectedFile] = useState(null);\n  // 使用 useReducer 管理上传状态\n  const [state, dispatch] = useReducer(uploadReducer, initialState);\n  // 使用 useRef 创建取消令牌\n  const cancelTokenSource = useRef(null);\n\n  // 定义一个处理文件选择事件的函数\n  const handleFileChange = e => {\n    setSelectedFile(e.target.files[0]);\n  };\n\n  // 添加可恢复上传功能\n  const handleUpload = async () => {\n    if (!selectedFile) return;\n\n    // 创建新的取消令牌\n    cancelTokenSource.current = axios.CancelToken.source();\n    const formData = new FormData();\n    formData.append('file', selectedFile);\n    formData.append('patient_name', '测试患者'); // 添加默认患者信息\n    formData.append('patient_id', 'test-' + Date.now());\n    try {\n      dispatch({\n        type: 'START_UPLOAD'\n      });\n      console.log('开始上传文件:', selectedFile.name);\n      const response = await axios.post(`${API_BASE}/api/process`, formData, {\n        cancelToken: cancelTokenSource.current.token,\n        onUploadProgress: e => {\n          const progress = Math.round(e.loaded * 100 / e.total);\n          dispatch({\n            type: 'UPDATE_PROGRESS',\n            payload: progress\n          });\n        }\n      });\n      console.log('上传响应:', response.data);\n\n      // 启动轮询机制\n      const pollResult = async taskId => {\n        try {\n          console.log('开始轮询任务状态:', taskId);\n          const {\n            data\n          } = await axios.get(`${API_BASE}/api/tasks/${taskId}`);\n          console.log('任务状态:', data);\n          if (data.status === 'completed') {\n            dispatch({\n              type: 'SUCCESS',\n              payload: data.results\n            });\n            return;\n          } else if (data.status === 'failed') {\n            throw new Error(data.error || '处理失败');\n          }\n          setTimeout(() => pollResult(taskId), 2000);\n        } catch (error) {\n          console.error('轮询错误:', error);\n          dispatch({\n            type: 'ERROR',\n            payload: error.message\n          });\n        }\n      };\n      pollResult(response.data.task_id);\n    } catch (error) {\n      console.error('上传错误:', error);\n      if (error.response) {\n        // 服务器响应了，但状态码不在 2xx 范围内\n        console.error('错误响应:', error.response.data);\n        dispatch({\n          type: 'ERROR',\n          payload: error.response.data.error || '上传失败'\n        });\n      } else if (error.request) {\n        // 请求已发出，但没有收到响应\n        console.error('未收到响应:', error.request);\n        dispatch({\n          type: 'ERROR',\n          payload: '服务器无响应'\n        });\n      } else {\n        // 发送请求时出了点问题\n        console.error('请求错误:', error.message);\n        dispatch({\n          type: 'ERROR',\n          payload: error.message\n        });\n      }\n    }\n  };\n\n  // 组件卸载时取消所有请求\n  React.useEffect(() => {\n    return () => {\n      if (cancelTokenSource.current) {\n        cancelTokenSource.current.cancel('组件卸载，取消请求');\n      }\n    };\n  }, []);\n\n  // 返回 JSX 元素，用于渲染组件的 UI\n  return /*#__PURE__*/_jsxDEV(Router, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"app-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"nav\", {\n        className: \"main-nav\",\n        children: [/*#__PURE__*/_jsxDEV(Link, {\n          to: \"/\",\n          children: \"\\u9996\\u9875\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/upload\",\n          children: \"\\u4E0A\\u4F20\\u56FE\\u50CF\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/compare\",\n          children: \"\\u56FE\\u50CF\\u5BF9\\u6BD4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/data\",\n          children: \"\\u6570\\u636E\\u7BA1\\u7406\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n        className: \"main-content\",\n        children: /*#__PURE__*/_jsxDEV(Routes, {\n          children: [/*#__PURE__*/_jsxDEV(Route, {\n            path: \"/\",\n            element: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"home-page\",\n              children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n                children: \"MRI\\u56FE\\u50CF\\u5904\\u7406\\u7CFB\\u7EDF\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 147,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"\\u6B22\\u8FCE\\u4F7F\\u7528MRI\\u56FE\\u50CF\\u5904\\u7406\\u7CFB\\u7EDF\\uFF0C\\u8BF7\\u9009\\u62E9\\u4EE5\\u4E0B\\u529F\\u80FD\\uFF1A\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 148,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"feature-grid\",\n                children: [/*#__PURE__*/_jsxDEV(Link, {\n                  to: \"/upload\",\n                  className: \"feature-card\",\n                  children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                    children: \"\\u4E0A\\u4F20\\u56FE\\u50CF\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 151,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    children: \"\\u4E0A\\u4F20\\u5E76\\u5904\\u7406MRI\\u56FE\\u50CF\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 152,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 150,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(Link, {\n                  to: \"/compare\",\n                  className: \"feature-card\",\n                  children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                    children: \"\\u56FE\\u50CF\\u5BF9\\u6BD4\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 155,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    children: \"\\u5BF9\\u6BD4\\u539F\\u59CB\\u56FE\\u50CF\\u548C\\u5904\\u7406\\u7ED3\\u679C\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 156,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 154,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(Link, {\n                  to: \"/data\",\n                  className: \"feature-card\",\n                  children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                    children: \"\\u6570\\u636E\\u7BA1\\u7406\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 159,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    children: \"\\u7BA1\\u7406\\u60A3\\u8005\\u6570\\u636E\\u548C\\u62A5\\u544A\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 160,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 158,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 149,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 146,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 145,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/upload\",\n            element: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"upload-page\",\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                children: \"\\u4E0A\\u4F20MRI\\u56FE\\u50CF\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 168,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"upload-section\",\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"file\",\n                  onChange: handleFileChange,\n                  accept: \".dcm,.nii,.nii.gz\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 170,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: handleUpload,\n                  disabled: !selectedFile || state.status === 'uploading',\n                  children: state.status === 'uploading' ? '上传中...' : '上传'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 171,\n                  columnNumber: 37\n                }, this), state.progress > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"progress-bar\",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"progress-fill\",\n                    style: {\n                      width: `${state.progress}%`\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 176,\n                    columnNumber: 45\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 175,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 169,\n                columnNumber: 33\n              }, this), selectedFile && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"preview-section\",\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  children: \"\\u56FE\\u50CF\\u9884\\u89C8\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 185,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(DICOMViewer, {\n                  imageUrl: URL.createObjectURL(selectedFile)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 186,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 184,\n                columnNumber: 37\n              }, this), state.error && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"error-message\",\n                children: state.error\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 190,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 167,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/compare\",\n            element: /*#__PURE__*/_jsxDEV(ComparisonView, {\n              originalImage: selectedFile ? URL.createObjectURL(selectedFile) : null,\n              processedImage: state.result ? `${API_BASE}/uploads/${state.result}` : null\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 198,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/data\",\n            element: /*#__PURE__*/_jsxDEV(DataManager, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 204,\n              columnNumber: 54\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 134,\n    columnNumber: 9\n  }, this);\n}\n\n// 导出 App 组件，以便在其他文件中使用\n_s(App, \"QaGqGmS5tsojratHFvOdmcjVcjU=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useReducer","useRef","axios","BrowserRouter","Router","Routes","Route","Link","DICOMViewer","ImageViewer","ComparisonView","DataManager","jsxDEV","_jsxDEV","API_BASE","process","env","REACT_APP_API_BASE","initialState","taskId","status","progress","result","error","uploadReducer","state","action","type","payload","App","_s","selectedFile","setSelectedFile","dispatch","cancelTokenSource","handleFileChange","e","target","files","handleUpload","current","CancelToken","source","formData","FormData","append","Date","now","console","log","name","response","post","cancelToken","token","onUploadProgress","Math","round","loaded","total","data","pollResult","get","results","Error","setTimeout","message","task_id","request","useEffect","cancel","children","className","to","fileName","_jsxFileName","lineNumber","columnNumber","path","element","onChange","accept","onClick","disabled","style","width","imageUrl","URL","createObjectURL","originalImage","processedImage","_c","$RefreshReg$"],"sources":["D:/GitHub/mri-web-app/frontend/src/App.js"],"sourcesContent":["// 导入 React 库中的 useState 和 useReducer 钩子，用于在函数组件中添加状态管理\r\nimport React, { useState, useReducer, useRef } from 'react';\r\n// 导入 axios 库，用于发送 HTTP 请求\r\nimport axios from 'axios';\r\n// 新增：导入 react-router-dom 中的 BrowserRouter 重命名为 Router，Routes 和 Route 组件\r\nimport { BrowserRouter as Router, Routes, Route, Link } from 'react-router-dom';\r\nimport DICOMViewer from './components/Viewer/DICOMViewer';\r\n// 导入 ImageViewer 和 ComparisonView 组件\r\nimport ImageViewer from './components/Viewer/ImageViewer';\r\nimport ComparisonView from './components/Viewer/ComparisonView';\r\nimport DataManager from './components/DataManagement/DataManager';\r\nimport './styles/dicom.css';\r\nimport './styles/App.css';\r\n// 新增环境变量配置\r\nconst API_BASE = process.env.REACT_APP_API_BASE || 'http://localhost:5000';\r\n\r\n// 使用useReducer整合状态\r\nconst initialState = {\r\n    taskId: null,\r\n    status: 'idle', // 'idle' | 'uploading' | 'processing' | 'completed' | 'failed'\r\n    progress: 0,\r\n    result: null,\r\n    error: null\r\n};\r\n\r\nfunction uploadReducer(state, action) {\r\n    switch (action.type) {\r\n        case 'START_UPLOAD':\r\n            return { ...state, status: 'uploading', progress: 0 };\r\n        case 'UPDATE_PROGRESS':\r\n            return { ...state, progress: action.payload };\r\n        case 'PROCESS_START':\r\n            return { ...state, status: 'processing', taskId: action.payload };\r\n        case 'SUCCESS':\r\n            return { ...state, status: 'completed', result: action.payload };\r\n        case 'ERROR':\r\n            return { ...state, status: 'failed', error: action.payload };\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\n// 定义一个名为 App 的函数组件，这是整个应用的根组件\r\nfunction App() {\r\n    // 使用 useState 钩子创建状态变量 selectedFile，用于存储用户选择的文件\r\n    const [selectedFile, setSelectedFile] = useState(null);\r\n    // 使用 useReducer 管理上传状态\r\n    const [state, dispatch] = useReducer(uploadReducer, initialState);\r\n    // 使用 useRef 创建取消令牌\r\n    const cancelTokenSource = useRef(null);\r\n\r\n    // 定义一个处理文件选择事件的函数\r\n    const handleFileChange = (e) => {\r\n        setSelectedFile(e.target.files[0]);\r\n    };\r\n\r\n    // 添加可恢复上传功能\r\n    const handleUpload = async () => {\r\n        if (!selectedFile) return;\r\n\r\n        // 创建新的取消令牌\r\n        cancelTokenSource.current = axios.CancelToken.source();\r\n\r\n        const formData = new FormData();\r\n        formData.append('file', selectedFile);\r\n        formData.append('patient_name', '测试患者'); // 添加默认患者信息\r\n        formData.append('patient_id', 'test-' + Date.now());\r\n        \r\n        try {\r\n            dispatch({ type: 'START_UPLOAD' });\r\n            \r\n            console.log('开始上传文件:', selectedFile.name);\r\n            const response = await axios.post(`${API_BASE}/api/process`, formData, {\r\n                cancelToken: cancelTokenSource.current.token,\r\n                onUploadProgress: (e) => {\r\n                    const progress = Math.round((e.loaded * 100) / e.total);\r\n                    dispatch({ type: 'UPDATE_PROGRESS', payload: progress });\r\n                }\r\n            });\r\n\r\n            console.log('上传响应:', response.data);\r\n\r\n            // 启动轮询机制\r\n            const pollResult = async (taskId) => {\r\n                try {\r\n                    console.log('开始轮询任务状态:', taskId);\r\n                    const { data } = await axios.get(`${API_BASE}/api/tasks/${taskId}`);\r\n                    console.log('任务状态:', data);\r\n                    \r\n                    if (data.status === 'completed') {\r\n                        dispatch({ type: 'SUCCESS', payload: data.results });\r\n                        return;\r\n                    } else if (data.status === 'failed') {\r\n                        throw new Error(data.error || '处理失败');\r\n                    }\r\n                    \r\n                    setTimeout(() => pollResult(taskId), 2000);\r\n                } catch (error) {\r\n                    console.error('轮询错误:', error);\r\n                    dispatch({ type: 'ERROR', payload: error.message });\r\n                }\r\n            };\r\n\r\n            pollResult(response.data.task_id);\r\n        } catch (error) {\r\n            console.error('上传错误:', error);\r\n            if (error.response) {\r\n                // 服务器响应了，但状态码不在 2xx 范围内\r\n                console.error('错误响应:', error.response.data);\r\n                dispatch({ type: 'ERROR', payload: error.response.data.error || '上传失败' });\r\n            } else if (error.request) {\r\n                // 请求已发出，但没有收到响应\r\n                console.error('未收到响应:', error.request);\r\n                dispatch({ type: 'ERROR', payload: '服务器无响应' });\r\n            } else {\r\n                // 发送请求时出了点问题\r\n                console.error('请求错误:', error.message);\r\n                dispatch({ type: 'ERROR', payload: error.message });\r\n            }\r\n        }\r\n    };\r\n\r\n    // 组件卸载时取消所有请求\r\n    React.useEffect(() => {\r\n        return () => {\r\n            if (cancelTokenSource.current) {\r\n                cancelTokenSource.current.cancel('组件卸载，取消请求');\r\n            }\r\n        };\r\n    }, []);\r\n\r\n    // 返回 JSX 元素，用于渲染组件的 UI\r\n    return (\r\n        <Router>\r\n            <div className=\"app-container\">\r\n                <nav className=\"main-nav\">\r\n                    <Link to=\"/\">首页</Link>\r\n                    <Link to=\"/upload\">上传图像</Link>\r\n                    <Link to=\"/compare\">图像对比</Link>\r\n                    <Link to=\"/data\">数据管理</Link>\r\n                </nav>\r\n\r\n                <main className=\"main-content\">\r\n                    <Routes>\r\n                        <Route path=\"/\" element={\r\n                            <div className=\"home-page\">\r\n                                <h1>MRI图像处理系统</h1>\r\n                                <p>欢迎使用MRI图像处理系统，请选择以下功能：</p>\r\n                                <div className=\"feature-grid\">\r\n                                    <Link to=\"/upload\" className=\"feature-card\">\r\n                                        <h3>上传图像</h3>\r\n                                        <p>上传并处理MRI图像</p>\r\n                                    </Link>\r\n                                    <Link to=\"/compare\" className=\"feature-card\">\r\n                                        <h3>图像对比</h3>\r\n                                        <p>对比原始图像和处理结果</p>\r\n                                    </Link>\r\n                                    <Link to=\"/data\" className=\"feature-card\">\r\n                                        <h3>数据管理</h3>\r\n                                        <p>管理患者数据和报告</p>\r\n                                    </Link>\r\n                                </div>\r\n                            </div>\r\n                        } />\r\n                        \r\n                        <Route path=\"/upload\" element={\r\n                            <div className=\"upload-page\">\r\n                                <h2>上传MRI图像</h2>\r\n                                <div className=\"upload-section\">\r\n                                    <input type=\"file\" onChange={handleFileChange} accept=\".dcm,.nii,.nii.gz\" />\r\n                                    <button onClick={handleUpload} disabled={!selectedFile || state.status === 'uploading'}>\r\n                                        {state.status === 'uploading' ? '上传中...' : '上传'}\r\n                                    </button>\r\n                                    {state.progress > 0 && (\r\n                                        <div className=\"progress-bar\">\r\n                                            <div \r\n                                                className=\"progress-fill\"\r\n                                                style={{ width: `${state.progress}%` }}\r\n                                            ></div>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                                {selectedFile && (\r\n                                    <div className=\"preview-section\">\r\n                                        <h3>图像预览</h3>\r\n                                        <DICOMViewer imageUrl={URL.createObjectURL(selectedFile)} />\r\n                                    </div>\r\n                                )}\r\n                                {state.error && (\r\n                                    <div className=\"error-message\">\r\n                                        {state.error}\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        } />\r\n                        \r\n                        <Route path=\"/compare\" element={\r\n                            <ComparisonView \r\n                                originalImage={selectedFile ? URL.createObjectURL(selectedFile) : null}\r\n                                processedImage={state.result ? `${API_BASE}/uploads/${state.result}` : null}\r\n                            />\r\n                        } />\r\n                        \r\n                        <Route path=\"/data\" element={<DataManager />} />\r\n                    </Routes>\r\n                </main>\r\n            </div>\r\n        </Router>\r\n    );\r\n}\r\n\r\n// 导出 App 组件，以便在其他文件中使用\r\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}